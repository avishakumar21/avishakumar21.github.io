# Final Design

**Introduction:**  
The final competition was a culmination of not only the concepts and labs of ECE 3400: Intelligent Physical Systems, but also the material covered in many foundational electrical and computer engineering classes. We explored and practiced circuitry, digital logic, programming microcontrollers, sensors, signal processing, image processing, mechanical design, and teamwork on a daily basis and were able to enhance and refine our skills in these topics. By the day of the final competition, our robot should have been able to:  
* Start on a 660 Hz tone
* Line follow
* Detect and avoid walls
* Traverse a maze using an optimized search algorithm
* Use a camera and FPGA to detect shapes and colors
* Transmit the maze traversal to a GUI
* Avoid other robots using IR Hats
  
While on the day of the final competition we were unable to demonstrate all these capabilities, we can confidently say that we learned how to implement each of these milestones on our robot throughout the semester. We discluded the camera feature in order to improve our chances of winning on competition day. Our final robot was able to perceive its environment using different kinds of sensors, reason through the information it was given by processing data using fast fourier transforms and updating appropriate data structures, and act accordingly determined by the logic and algorithms that we had set up in the code. 

Our intelligent physical system, LEAK, demonstrates almost all of these qualities in the maze traversal below:
  
Pictures of our robot:



**Schematics**   
![alt text](/assets/finaldesign/arduino.png)
Figure 1: Arduino Schematic
![alt text](/assets/finaldesign/mux.png)
Figure 2: Mux Schematic

**Robot Cost:**  

**Design:**

*Start Tone:*
To begin at a start tone, we used the microphone circuit designed in lab 2. In our original robot integration code, we ran a 256 point FFT to detect peaks in frequency data at 660Hz, indicating a start tone. For our final code, however, a 256 point FFT used far too much memory. We therefore chose to reduce the number of bins generated by the FFT from 256 to 64 by changing the FFT_N variable from 256 to 64 and the for loop limit from 512 to 128. We then recalculated which bin would contain the 660Hz peak using the calculation described at the beginning of lab 2. We found that a peak above 120 in bin 3 indicated that the robot should start.  
*Movement:*   
In order to move, we had two servos connected to each wheel of the robot. These servos controlled the forward motion, turning left or right, and turning around. In order to move forward, the servos were sent the same signal to turn the wheel clockwise. If the robot needed to turn, one servo turned clockwise and the other turned counterclockwise depending on whether the turn was left or right. 
*Line Following:*  
We had three QTR sensors positioned in the front of our robot. To go straight, we used sensor values to choose one of three options in order to stay on a white line:  
1. If the middle line sensor indicated it was on white, while the left and right sensors indicated they were on black, we set both servos to the same speed and went straight.
2. If the left sensor saw white while the right sensor saw black, we set the right servo to be slightly faster than the left servo, thus correcting left. 
3. If the right sensor saw black while the left sensor saw right, we set the left servo to be slightly faster than the right servo, thus correcting right.








